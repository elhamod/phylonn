program: main.py
# name: sweep1
project: Phylo-VQVAE
command:
  - ${env}
  - ${interpreter}
  - ${program}
  - "-t"
  - "True"
  - "--gpus"
  - "0,"
  - "--name"
  - "Phylo-VQVAE"
  - ${args_no_hyphens}
method: grid
metric:
  goal: minimize
  name: val/disentangler_phylo_loss
  target: 1.0
parameters:
  model:
    parameters:
      base_learning_rate: 
        value: 5e-6
      target: 
        value: taming.models.phyloautoencoder.PhyloVQVAE
      
      params:
        parameters:
          ckpt_path: 
            value: /home/elhamod/projects/taming-transformers/logs/256pixels_256embedding/checkpoints/last.ckpt
          embed_dim:
            value: 256
          n_embed:
            value: 1024

          ddconfig:
            parameters:
              double_z:
                value: False
              z_channels: 
                value: 256
              resolution:
                value: 256
              in_channels:
                value: 3
              out_ch:
                value: 3
              ch:
                value: 128
              ch_mult: 
                value: [ 1,1,2,2,4]  # num_down = len(ch_mult)-1
              num_res_blocks:
                value: 2
              attn_resolutions:
                value: [16]
              dropout:
                value: 0.0
          lossconfig:
            parameters:
              target: 
                value: taming.modules.losses.DummyLoss
          phylomodel_params:
            parameters:
              embed_dim:
                value: 16
              n_embed:
                value: 64
              #
              n_phylolevels: 
                value: 4
              codebooks_per_phylolevel:
                value : 8
              #
              n_phylo_channels:
                value: 32
              # NOT hyperparameters.
              resolution:
                value: 16 #32
              in_channels:
                value: 256
              out_ch:
                value: 256
              ch:
                values:
                - 48
                - 40
                - 36

              lossconfig:
                parameters:
                  target: 
                    value: taming.modules.losses.vqperceptual.VQLPIPSWithDiscriminator
                  params:
                    parameters:
                      codebook_weight:
                        value: 1.0
                      disc_in_channels:
                        value: 0
                      disc_num_layers:
                        value: 0
                      disc_weight:
                        value: 0.0
                      disc_factor:
                        value: 0.0
                      perceptual_weight:
                        value: 0.0
                      disc_start: 
                        value: 10000
              
              lossconfig_kernelorthogonality:
                parameters:
                  target: 
                    value: taming.modules.losses.orthogonalloss.OrthogonalLoss
                  params:
                    parameters:
                      weight: 
                        value: 1.0
                      padding: 
                        value: 0
                      stride: 
                        value: 1
              
              lossconfig_phylo:
                parameters:
                  target: 
                    value: taming.modules.losses.phyloloss.PhyloLoss
                  params:
                    parameters:
                      phylo_weight:
                        value: 0.1
                      phyloDistances_string:
                        value: "0.77,0.5,0.33"
                      fc_layers:
                        value: 1
                      phylogenyconfig:
                        parameters:
                          target:
                            value: taming.data.phylogeny.Phylogeny
                          params:
                            parameters:
                              filePath:
                                value: /home/elhamod/data/Fish
  data:
    parameters:
      target: 
        value: main.DataModuleFromConfig
      params:
        parameters:
          batch_size:
            value: 5
          num_workers:
            value: 8
          train:
            parameters:
              target: 
                value: taming.data.custom.CustomTrain
              params:
                parameters:
                  training_images_list_file: 
                    value: /home/elhamod/data/Fish/taming_transforms_fish_train_padded_256.txt
                  size:
                    value: 256
                  add_labels: 
                    value: true

          validation:
            parameters:
              target:
                value: taming.data.custom.CustomTest
              params:
                parameters:
                  test_images_list_file: 
                    value: /home/elhamod/data/Fish/taming_transforms_fish_test_padded_256.txt
                  size:
                    value: 256
                  add_labels: 
                    value: true
  lightning:
    parameters:
      trainer:
        parameters:
          # max_epochs:
          #   value: 20
          profiler: 
            value: simple